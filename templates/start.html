<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Welcome to AIChatFlows Setup</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Montserrat:wght@600;700;800&display=swap" rel="stylesheet">
  <meta name="description" content="Start your AI-powered chatbot setup with AIChatFlows">
  <meta name="robots" content="noindex">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'brand-dark': '#0a0a0a',
            'brand-secondary': '#1a1a1a',
            'brand-primary': '#00e676',
            'brand-light': '#e0e0e0',
            'brand-blue': '#00b0ff',
            'brand-purple': '#e040fb'
          },
          fontFamily: {
            'sans': ['Inter', 'sans-serif'],
            'heading': ['Montserrat', 'sans-serif']
          }
        }
      }
    }
  </script>
</head>
<body class="bg-brand-dark text-brand-light font-sans">
  <div class="min-h-screen bg-brand-dark pt-12 pb-16">
    <div class="max-w-4xl mx-auto px-6">
      <!-- Header -->
      <div class="text-center mb-12">
        <h1 class="font-heading text-5xl font-bold text-brand-primary mb-4 leading-tight">
          🚀 AIChatFlows Setup
        </h1>
        <p class="text-xl text-brand-light opacity-90 max-w-2xl mx-auto leading-relaxed">
          Welcome! Let's get your AI-powered chatbot automation system set up. 
          This secure form will collect your business information and preferences.
        </p>
      </div>
      
      <!-- Form Container -->
      <div class="bg-brand-secondary rounded-2xl shadow-2xl border border-gray-800 p-8 md:p-12">
        <!-- Messages -->
        <div id="errorMessage" class="hidden bg-red-900/20 border border-red-500/30 text-red-400 px-6 py-4 rounded-lg mb-6 text-center"></div>
        <div id="successMessage" class="hidden bg-green-900/20 border border-green-500/30 text-brand-primary px-6 py-4 rounded-lg mb-6 text-center"></div>
        <div id="loadingSpinner" class="hidden text-center py-8">
          <div class="inline-block animate-spin rounded-full h-12 w-12 border-4 border-brand-primary border-t-transparent"></div>
        </div>
        
        <form id="onboardingForm" method="post" action="/api/submit-onboarding" enctype="multipart/form-data">
          <!-- 1. Business Information -->
          <div class="form-section mb-12 pb-8 border-b border-gray-700">
            <h2 class="text-2xl font-heading font-bold text-brand-primary mb-6 flex items-center gap-3">
              🧾 Business Information
            </h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <label for="business_name" class="block text-brand-light font-medium mb-2">Business Name *</label>
                <input type="text" id="business_name" name="business_name" required maxlength="100" 
                       class="w-full px-4 py-3 bg-brand-dark border border-gray-600 rounded-lg text-brand-light focus:border-brand-primary focus:outline-none transition-colors">
              </div>
              
              <div>
                <label for="instagram_handle" class="block text-brand-light font-medium mb-2">Business Instagram Handle *</label>
                <input type="text" id="instagram_handle" name="instagram_handle" required maxlength="30" placeholder="@yourbusiness"
                       class="w-full px-4 py-3 bg-brand-dark border border-gray-600 rounded-lg text-brand-light focus:border-brand-primary focus:outline-none transition-colors">
              </div>
              
              <div>
                <label for="other_platforms" class="block text-brand-light font-medium mb-2">Other Platforms to Integrate</label>
                <input type="text" id="other_platforms" name="other_platforms" maxlength="200" placeholder="TikTok, Facebook, etc."
                       class="w-full px-4 py-3 bg-brand-dark border border-gray-600 rounded-lg text-brand-light focus:border-brand-primary focus:outline-none transition-colors">
              </div>
              
              <div>
                <label for="business_type" class="block text-brand-light font-medium mb-2">Business Type or Niche *</label>
                <select id="business_type" name="business_type" required 
                        class="w-full px-4 py-3 bg-brand-dark border border-gray-600 rounded-lg text-brand-light focus:border-brand-primary focus:outline-none transition-colors">
                  <option value="">Select your business type</option>
                  <option value="Restaurant">Restaurant</option>
                  <option value="Retail">Retail</option>
                  <option value="Service">Service</option>
                  <option value="E-commerce">E-commerce</option>
                  <option value="Healthcare">Healthcare</option>
                  <option value="Beauty & Wellness">Beauty & Wellness</option>
                  <option value="Real Estate">Real Estate</option>
                  <option value="Education">Education</option>
                  <option value="Other">Other</option>
                </select>
              </div>
            </div>
            
            <div class="mt-6">
              <label for="product_service_description" class="block text-brand-light font-medium mb-2">What products or services do you offer? *</label>
              <textarea id="product_service_description" name="product_service_description" required maxlength="1000" rows="4" 
                        placeholder="Describe your main products or services..."
                        class="w-full px-4 py-3 bg-brand-dark border border-gray-600 rounded-lg text-brand-light focus:border-brand-primary focus:outline-none transition-colors resize-none"></textarea>
            </div>
            
            <div class="mt-6">
              <label for="common_customer_question" class="block text-brand-light font-medium mb-2">What are the most common questions your customers ask? *</label>
              <textarea id="common_customer_question" name="common_customer_question" required maxlength="500" rows="3" 
                        placeholder="e.g., Hours, pricing, availability, location..."
                        class="w-full px-4 py-3 bg-brand-dark border border-gray-600 rounded-lg text-brand-light focus:border-brand-primary focus:outline-none transition-colors resize-none"></textarea>
            </div>
          </div>
          
          <!-- 2. Delivery & Pickup Info -->
          <div class="form-section mb-12 pb-8 border-b border-gray-700">
            <h2 class="text-2xl font-heading font-bold text-brand-primary mb-6 flex items-center gap-3">
              🧾 Delivery & Pickup Info
            </h2>
            
            <div class="mb-6">
              <label class="block text-brand-light font-medium mb-4">Do you offer delivery or pickup? *</label>
              <div class="space-y-3">
                <label class="flex items-center cursor-pointer">
                  <input type="radio" name="delivery_pickup" value="Delivery" required class="text-brand-primary focus:ring-brand-primary mr-3">
                  <span class="text-brand-light">Delivery only</span>
                </label>
                <label class="flex items-center cursor-pointer">
                  <input type="radio" name="delivery_pickup" value="Pickup" required class="text-brand-primary focus:ring-brand-primary mr-3">
                  <span class="text-brand-light">Pickup only</span>
                </label>
                <label class="flex items-center cursor-pointer">
                  <input type="radio" name="delivery_pickup" value="Both" required class="text-brand-primary focus:ring-brand-primary mr-3">
                  <span class="text-brand-light">Both</span>
                </label>
                <label class="flex items-center cursor-pointer">
                  <input type="radio" name="delivery_pickup" value="Neither" required class="text-brand-primary focus:ring-brand-primary mr-3">
                  <span class="text-brand-light">Neither</span>
                </label>
              </div>
            </div>
            
            <!-- Delivery Services (conditional) -->
            <div id="deliveryServices" class="conditional-section hidden">
              <div class="bg-brand-dark/50 border border-brand-primary/30 rounded-lg p-6 mb-4">
                <h3 class="text-lg font-semibold text-brand-primary mb-4">Delivery Service Options</h3>
                <div class="space-y-3">
                  <label class="flex items-center cursor-pointer">
                    <input type="checkbox" name="delivery_services" value="Uber Eats" class="text-brand-primary focus:ring-brand-primary mr-3">
                    <span class="text-brand-light">Uber Eats</span>
                  </label>
                  <label class="flex items-center cursor-pointer">
                    <input type="checkbox" name="delivery_services" value="DoorDash" class="text-brand-primary focus:ring-brand-primary mr-3">
                    <span class="text-brand-light">DoorDash</span>
                  </label>
                  <label class="flex items-center cursor-pointer">
                    <input type="checkbox" name="delivery_services" value="Grubhub" class="text-brand-primary focus:ring-brand-primary mr-3">
                    <span class="text-brand-light">Grubhub</span>
                  </label>
                  <label class="flex items-center cursor-pointer">
                    <input type="checkbox" name="delivery_services" value="In-house delivery" class="text-brand-primary focus:ring-brand-primary mr-3">
                    <span class="text-brand-light">In-house delivery</span>
                  </label>
                </div>
                <div class="mt-4">
                  <label for="delivery_other" class="block text-brand-light font-medium mb-2">Other delivery service:</label>
                  <input type="text" id="delivery_other" name="delivery_other" placeholder="Specify other delivery service..."
                         class="w-full px-4 py-3 bg-brand-dark border border-gray-600 rounded-lg text-brand-light focus:border-brand-primary focus:outline-none transition-colors">
                </div>
              </div>
            </div>
            
            <!-- Pickup Options (conditional) -->
            <div id="pickupOptions" class="conditional-section hidden">
              <div class="bg-brand-dark/50 border border-brand-primary/30 rounded-lg p-6 mb-4">
                <h3 class="text-lg font-semibold text-brand-primary mb-4">How does pickup work?</h3>
                <div class="space-y-3 mb-4">
                  <label class="flex items-center cursor-pointer">
                    <input type="radio" name="pickup_method" value="Customers call to place an order" class="text-brand-primary focus:ring-brand-primary mr-3">
                    <span class="text-brand-light">Customers call to place an order</span>
                  </label>
                  <label class="flex items-center cursor-pointer">
                    <input type="radio" name="pickup_method" value="Customers use an app or link" class="text-brand-primary focus:ring-brand-primary mr-3">
                    <span class="text-brand-light">Customers use an app or link</span>
                  </label>
                  <label class="flex items-center cursor-pointer">
                    <input type="radio" name="pickup_method" value="Walk-in only" class="text-brand-primary focus:ring-brand-primary mr-3">
                    <span class="text-brand-light">Walk-in only</span>
                  </label>
                </div>
                <div>
                  <label for="pickup_details" class="block text-brand-light font-medium mb-2">Add details or link:</label>
                  <input type="text" id="pickup_details" name="pickup_details" placeholder="App name, website, or additional details..."
                         class="w-full px-4 py-3 bg-brand-dark border border-gray-600 rounded-lg text-brand-light focus:border-brand-primary focus:outline-none transition-colors">
                </div>
              </div>
            </div>
          </div>
          
          <!-- 3. Menu Submission -->
          <div class="form-section mb-12 pb-8 border-b border-gray-700">
            <h2 class="text-2xl font-heading font-bold text-brand-primary mb-6 flex items-center gap-3">
              📋 Menu Submission
            </h2>
            
            <div class="space-y-6">
              <div>
                <label for="menu_upload" class="block text-brand-light font-medium mb-2">Upload your menu (JPG, PNG, PDF, max 5MB)</label>
                <input type="file" id="menu_upload" name="menu_upload" accept=".jpg,.jpeg,.png,.pdf" 
                       class="w-full px-4 py-3 bg-brand-dark border border-gray-600 rounded-lg text-brand-light focus:border-brand-primary focus:outline-none transition-colors file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-brand-primary file:text-brand-dark hover:file:bg-brand-primary/80">
                <p id="menuFileInfo" class="text-sm text-gray-400 mt-2">No file selected</p>
              </div>
              
              <div class="text-center text-brand-light/70 font-medium">OR</div>
              
              <div>
                <label for="menu_text" class="block text-brand-light font-medium mb-2">Paste your menu</label>
                <textarea id="menu_text" name="menu_text" rows="8" placeholder="Paste your menu items, prices, and descriptions here..."
                          class="w-full px-4 py-3 bg-brand-dark border border-gray-600 rounded-lg text-brand-light focus:border-brand-primary focus:outline-none transition-colors resize-none"></textarea>
              </div>
              
              <div>
                <label for="additional_docs" class="block text-brand-light font-medium mb-2">Upload additional docs: store photos, price sheets, chat screenshots</label>
                <input type="file" id="additional_docs" name="additional_docs" multiple accept=".jpg,.jpeg,.png,.pdf" 
                       class="w-full px-4 py-3 bg-brand-dark border border-gray-600 rounded-lg text-brand-light focus:border-brand-primary focus:outline-none transition-colors file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-brand-primary file:text-brand-dark hover:file:bg-brand-primary/80">
                <p id="additionalDocsInfo" class="text-sm text-gray-400 mt-2">No files selected</p>
              </div>
            </div>
          </div>
          
          <!-- 4. Login Credentials for Setup -->
          <div class="form-section mb-12 pb-8 border-b border-gray-700">
            <h2 class="text-2xl font-heading font-bold text-brand-primary mb-6 flex items-center gap-3">
              🔐 Login Credentials for Setup
            </h2>
            
            <div class="mb-6">
              <label class="block text-brand-light font-medium mb-4">Which plan are you signing up for? *</label>
              <div class="space-y-3">
                <label class="flex items-center cursor-pointer p-4 border border-gray-600 rounded-lg hover:border-brand-primary/50 transition-colors">
                  <input type="radio" name="plan" value="Starter" required class="text-brand-primary focus:ring-brand-primary mr-4">
                  <div>
                    <span class="text-brand-light font-semibold">Starter – $50 setup + $100/month</span>
                    <p class="text-sm text-gray-400 mt-1">Basic automation for Instagram</p>
                  </div>
                </label>
                <label class="flex items-center cursor-pointer p-4 border border-gray-600 rounded-lg hover:border-brand-primary/50 transition-colors">
                  <input type="radio" name="plan" value="Pro" required class="text-brand-primary focus:ring-brand-primary mr-4">
                  <div>
                    <span class="text-brand-light font-semibold">Pro – $50 setup + $150/month</span>
                    <p class="text-sm text-gray-400 mt-1">Multi-platform automation (Instagram, Facebook, TikTok)</p>
                  </div>
                </label>
              </div>
            </div>
            
            <div class="mb-6">
              <label class="block text-brand-light font-medium mb-4">How would you like to share your login credentials? *</label>
              <div class="space-y-3">
                <label class="flex items-center cursor-pointer">
                  <input type="radio" name="submission_method" value="Submit through this page" required class="text-brand-primary focus:ring-brand-primary mr-3">
                  <span class="text-brand-light">Submit credentials directly through this form</span>
                </label>
                <label class="flex items-center cursor-pointer">
                  <input type="radio" name="submission_method" value="Use SendSecure.ly" required class="text-brand-primary focus:ring-brand-primary mr-3">
                  <span class="text-brand-light">Use SendSecure.ly to share credentials</span>
                </label>
                <label class="flex items-center cursor-pointer">
                  <input type="radio" name="submission_method" value="Request In-Person Setup" required class="text-brand-primary focus:ring-brand-primary mr-3">
                  <span class="text-brand-light">I'd like to schedule a live call to give access</span>
                </label>
              </div>
            </div>
            
            <!-- SendSecure.ly Message -->
            <div id="sendSecurelyMessage" class="conditional-message hidden">
              <div class="bg-blue-900/20 border border-blue-500/30 rounded-lg p-6 mb-6">
                <div class="flex items-start gap-3">
                  <span class="text-2xl">📧</span>
                  <div>
                    <h4 class="font-semibold text-blue-300 mb-2">SendSecure.ly Selected</h4>
                    <p class="text-blue-100">You've chosen to use SendSecure.ly to share your login information. After submitting this form, we'll email you a private link where you can securely enter your credentials. Please keep an eye on your inbox!</p>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Login fields (conditional) -->
            <div id="loginSection" class="conditional-section hidden">
              <div class="bg-brand-dark/50 border border-brand-primary/30 rounded-lg p-6">
                <div class="flex items-center gap-2 mb-4">
                  <span class="text-xl">🛡️</span>
                  <p class="text-brand-light text-sm">Your login information is encrypted and only used for one-time setup. It is never saved.</p>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <div>
                    <label for="instagram_email" class="block text-brand-light font-medium mb-2">Instagram Username *</label>
                    <input type="text" id="instagram_email" name="instagram_email" autocomplete="off"
                           class="w-full px-4 py-3 bg-brand-dark border border-gray-600 rounded-lg text-brand-light focus:border-brand-primary focus:outline-none transition-colors">
                  </div>
                  
                  <div>
                    <label for="instagram_password" class="block text-brand-light font-medium mb-2">Instagram Password *</label>
                    <input type="password" id="instagram_password" name="instagram_password" autocomplete="off"
                           class="w-full px-4 py-3 bg-brand-dark border border-gray-600 rounded-lg text-brand-light focus:border-brand-primary focus:outline-none transition-colors">
                  </div>
                </div>
                
                <!-- Pro Plan Additional Fields -->
                <div id="proLoginSection" class="conditional-section hidden mt-6">
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                      <label for="facebook_email" class="block text-brand-light font-medium mb-2">Facebook Username (optional)</label>
                      <input type="text" id="facebook_email" name="facebook_email" autocomplete="off"
                             class="w-full px-4 py-3 bg-brand-dark border border-gray-600 rounded-lg text-brand-light focus:border-brand-primary focus:outline-none transition-colors">
                    </div>
                    
                    <div>
                      <label for="facebook_password" class="block text-brand-light font-medium mb-2">Facebook Password (optional)</label>
                      <input type="password" id="facebook_password" name="facebook_password" autocomplete="off"
                             class="w-full px-4 py-3 bg-brand-dark border border-gray-600 rounded-lg text-brand-light focus:border-brand-primary focus:outline-none transition-colors">
                    </div>
                  </div>
                </div>
                
                <div class="mt-6">
                  <label for="other_platform_credentials" class="block text-brand-light font-medium mb-2">Other Platform Credentials</label>
                  <textarea id="other_platform_credentials" name="other_platform_credentials" rows="3" 
                            placeholder="TikTok, WhatsApp, or other platform login details..."
                            class="w-full px-4 py-3 bg-brand-dark border border-gray-600 rounded-lg text-brand-light focus:border-brand-primary focus:outline-none transition-colors resize-none"></textarea>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 5. Additional FAQ & Support Docs -->
          <div class="form-section mb-12 pb-8 border-b border-gray-700">
            <h2 class="text-2xl font-heading font-bold text-brand-primary mb-6 flex items-center gap-3">
              ❓ Additional FAQ & Support Docs
            </h2>
            
            <div class="mb-6">
              <label class="block text-brand-light font-medium mb-4">Do you have a customer FAQ document?</label>
              <div class="space-y-3">
                <label class="flex items-center cursor-pointer">
                  <input type="radio" name="has_faqs" value="true" class="text-brand-primary focus:ring-brand-primary mr-3">
                  <span class="text-brand-light">Yes — Upload it below</span>
                </label>
                <label class="flex items-center cursor-pointer">
                  <input type="radio" name="has_faqs" value="false" class="text-brand-primary focus:ring-brand-primary mr-3">
                  <span class="text-brand-light">No — I'll let the bot learn from customer questions</span>
                </label>
              </div>
            </div>
            
            <div id="faqUploadSection" class="conditional-section hidden">
              <div class="bg-brand-dark/50 border border-brand-primary/30 rounded-lg p-6">
                <label for="faq_upload" class="block text-brand-light font-medium mb-2">Upload FAQ Document</label>
                <input type="file" id="faq_upload" name="faq_upload" accept=".pdf,.doc,.docx,.txt" 
                       class="w-full px-4 py-3 bg-brand-dark border border-gray-600 rounded-lg text-brand-light focus:border-brand-primary focus:outline-none transition-colors file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-brand-primary file:text-brand-dark hover:file:bg-brand-primary/80">
                <p id="faqFileInfo" class="text-sm text-gray-400 mt-2">No file selected</p>
              </div>
            </div>
          </div>
          
          <!-- 6. Contact for Updates & Support -->
          <div class="form-section mb-12 pb-8 border-b border-gray-700">
            <h2 class="text-2xl font-heading font-bold text-brand-primary mb-6 flex items-center gap-3">
              📧 Contact for Updates & Support
            </h2>
            
            <div>
              <label for="contact_email" class="block text-brand-light font-medium mb-2">Contact Email *</label>
              <input type="email" id="contact_email" name="contact_email" required maxlength="254"
                     class="w-full px-4 py-3 bg-brand-dark border border-gray-600 rounded-lg text-brand-light focus:border-brand-primary focus:outline-none transition-colors">
            </div>
          </div>
          
          <!-- 7. Confirmation & Consent -->
          <div class="form-section mb-12 pb-8 border-b border-gray-700">
            <h2 class="text-2xl font-heading font-bold text-brand-primary mb-6 flex items-center gap-3">
              ✅ Confirmation & Consent
            </h2>
            
            <div class="space-y-4">
              <label class="flex items-start cursor-pointer">
                <input type="checkbox" id="confirm_accurate" name="confirm_accurate" required class="text-brand-primary focus:ring-brand-primary mr-3 mt-1">
                <span class="text-brand-light">I confirm the information provided is accurate</span>
              </label>
              
              <label class="flex items-start cursor-pointer">
                <input type="checkbox" id="consent_automation" name="consent_automation" required class="text-brand-primary focus:ring-brand-primary mr-3 mt-1">
                <span class="text-brand-light">I consent to AIChatFlows setting up automation on my accounts</span>
              </label>
              
              <label class="flex items-start cursor-pointer">
                <input type="checkbox" id="consent_to_share" name="consent_to_share" required class="text-brand-primary focus:ring-brand-primary mr-3 mt-1">
                <span class="text-brand-light">I agree to the <a href="/legal#privacy" target="_blank" class="text-brand-primary hover:underline">Privacy Policy</a> and <a href="/legal#terms" target="_blank" class="text-brand-primary hover:underline">Terms of Service</a></span>
              </label>
            </div>
          </div>
          
          <!-- 8. Final Checklist Before Submitting -->
          <div class="form-section mb-12">
            <h2 class="text-2xl font-heading font-bold text-brand-primary mb-6 flex items-center gap-3">
              🔄 Final Checklist Before Submitting
            </h2>
            
            <div class="bg-brand-dark/50 border border-brand-primary/30 rounded-lg p-6">
              <div class="space-y-4">
                <label class="flex items-start cursor-pointer">
                  <input type="checkbox" id="checklist_menu" name="checklist_menu" class="text-brand-primary focus:ring-brand-primary mr-3 mt-1">
                  <span class="text-brand-light">I uploaded or wrote out my full menu</span>
                </label>
                
                <label class="flex items-start cursor-pointer">
                  <input type="checkbox" id="checklist_plan" name="checklist_plan" class="text-brand-primary focus:ring-brand-primary mr-3 mt-1">
                  <span class="text-brand-light">I selected a plan and filled in login details</span>
                </label>
                
                <label class="flex items-start cursor-pointer">
                  <input type="checkbox" id="checklist_delivery" name="checklist_delivery" class="text-brand-primary focus:ring-brand-primary mr-3 mt-1">
                  <span class="text-brand-light">I provided delivery/pickup service details</span>
                </label>
                
                <label class="flex items-start cursor-pointer">
                  <input type="checkbox" id="checklist_ready" name="checklist_ready" class="text-brand-primary focus:ring-brand-primary mr-3 mt-1">
                  <span class="text-brand-light">I'm ready to begin setup</span>
                </label>
              </div>
            </div>
          </div>
          
          <!-- Submit Button -->
          <div class="text-center">
            <button type="submit" id="submitButton" class="w-full md:w-auto px-12 py-4 bg-gradient-to-r from-brand-primary to-brand-blue text-white font-bold text-lg rounded-full shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300 disabled:opacity-50 disabled:transform-none">
              🎉 Start My Setup
            </button>
          </div>
          
          <p class="text-center text-sm text-gray-400 mt-6">
            🔒 Your information is encrypted and secure. We take your privacy seriously.<br>
            <a href="/legal#privacy" class="text-brand-primary hover:underline">Privacy Policy</a> | 
            <a href="/legal#terms" class="text-brand-primary hover:underline">Terms of Service</a>
          </p>
        </form>
      </div>
    </div>
  </div>
  
  <!-- Enhanced JavaScript -->
  <script>
    (function() {
      'use strict';
      
      // Security measures
      document.addEventListener('contextmenu', e => e.preventDefault());
      document.addEventListener('keydown', e => {
        if (e.keyCode === 123 || (e.ctrlKey && e.shiftKey && e.keyCode === 73) || (e.ctrlKey && e.keyCode === 85)) {
          e.preventDefault();
        }
      });
      
      // Input sanitization
      function sanitizeInput(input) {
        if (typeof input !== 'string') return input;
        return input.replace(/[<>]/g, '').replace(/javascript:/gi, '').replace(/vbscript:/gi, '').replace(/on\\w+\\s*=/gi, '').trim();
      }
      
      // Form validation
      function validateEmail(email) {
        const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/;
        return emailRegex.test(email);
      }
      
      function validateRequired(value) {
        return value !== null && value !== undefined && value.toString().trim() !== '';
      }
      
      // File upload validation
      function validateFileUpload(file, maxSize = 5 * 1024 * 1024) {
        const allowedTypes = ['application/pdf', 'image/jpeg', 'image/png', 'image/jpg'];
        return allowedTypes.includes(file.type) && file.size <= maxSize;
      }
      
      // Initialize when DOM is ready
      document.addEventListener('DOMContentLoaded', function() {
        const form = document.getElementById('onboardingForm');
        const errorMessage = document.getElementById('errorMessage');
        const successMessage = document.getElementById('successMessage');
        const loadingSpinner = document.getElementById('loadingSpinner');
        const submitButton = document.getElementById('submitButton');
        
        // File upload handlers
        function setupFileUpload(inputId, infoId) {
          const fileInput = document.getElementById(inputId);
          const fileInfo = document.getElementById(infoId);
          
          if (!fileInput || !fileInfo) return;
          
          fileInput.addEventListener('change', function() {
            const files = this.files;
            if (files.length > 0) {
              let validFiles = [];
              for (let file of files) {
                if (validateFileUpload(file)) {
                  validFiles.push(file.name);
                }
              }
              
              if (validFiles.length > 0) {
                fileInfo.textContent = `Selected: ${validFiles.join(', ')}`;
                fileInfo.className = 'text-sm text-green-400 mt-2';
              } else {
                fileInfo.textContent = 'Invalid file type or size. Please select PDF, JPG, or PNG files under 5MB.';
                fileInfo.className = 'text-sm text-red-400 mt-2';
                this.value = '';
              }
            } else {
              fileInfo.textContent = 'No file selected';
              fileInfo.className = 'text-sm text-gray-400 mt-2';
            }
          });
        }
        
        // Setup file uploads
        setupFileUpload('menu_upload', 'menuFileInfo');
        setupFileUpload('additional_docs', 'additionalDocsInfo');
        setupFileUpload('faq_upload', 'faqFileInfo');
        
        // Conditional field display logic
        function updateDeliveryPickupFields() {
          const selectedValue = document.querySelector('input[name="delivery_pickup"]:checked')?.value;
          const deliveryServices = document.getElementById('deliveryServices');
          const pickupOptions = document.getElementById('pickupOptions');
          
          deliveryServices.classList.add('hidden');
          pickupOptions.classList.add('hidden');
          
          if (selectedValue === 'Delivery' || selectedValue === 'Both') {
            deliveryServices.classList.remove('hidden');
          }
          if (selectedValue === 'Pickup' || selectedValue === 'Both') {
            pickupOptions.classList.remove('hidden');
          }
        }
        
        function updateLoginFields() {
          const selectedPlan = document.querySelector('input[name="plan"]:checked')?.value;
          const selectedMethod = document.querySelector('input[name="submission_method"]:checked')?.value;
          const loginSection = document.getElementById('loginSection');
          const proLoginSection = document.getElementById('proLoginSection');
          const sendSecurelyMessage = document.getElementById('sendSecurelyMessage');
          
          loginSection.classList.add('hidden');
          proLoginSection.classList.add('hidden');
          sendSecurelyMessage.classList.add('hidden');
          
          if (selectedMethod === 'Submit through this page') {
            loginSection.classList.remove('hidden');
            if (selectedPlan === 'Pro') {
              proLoginSection.classList.remove('hidden');
            }
          } else if (selectedMethod === 'Use SendSecure.ly') {
            sendSecurelyMessage.classList.remove('hidden');
          }
        }
        
        function updateFaqSection() {
          const hasFaqs = document.querySelector('input[name="has_faqs"]:checked')?.value;
          const faqUploadSection = document.getElementById('faqUploadSection');
          
          if (hasFaqs === 'true') {
            faqUploadSection.classList.remove('hidden');
          } else {
            faqUploadSection.classList.add('hidden');
          }
        }
        
        // Event listeners
        document.querySelectorAll('input[name="delivery_pickup"]').forEach(radio => {
          radio.addEventListener('change', updateDeliveryPickupFields);
        });
        
        document.querySelectorAll('input[name="plan"]').forEach(radio => {
          radio.addEventListener('change', updateLoginFields);
        });
        
        document.querySelectorAll('input[name="submission_method"]').forEach(radio => {
          radio.addEventListener('change', updateLoginFields);
        });
        
        document.querySelectorAll('input[name="has_faqs"]').forEach(radio => {
          radio.addEventListener('change', updateFaqSection);
        });
        
        // Form submission
        form.addEventListener('submit', function(e) {
          e.preventDefault();
          
          if (submitButton.disabled) return;
          
          // Show loading state
          loadingSpinner.classList.remove('hidden');
          errorMessage.classList.add('hidden');
          successMessage.classList.add('hidden');
          submitButton.disabled = true;
          submitButton.textContent = 'Processing...';
          
          // Collect form data
          const formData = new FormData(form);
          const data = {};
          
          // Convert FormData to object
          for (let [key, value] of formData.entries()) {
            if (key === 'delivery_services') {
              if (!data.delivery_services) data.delivery_services = [];
              data.delivery_services.push(sanitizeInput(value));
            } else if (key.startsWith('checklist_')) {
              // Handle checklist items
              if (!data.checklist_items) data.checklist_items = [];
              if (value) data.checklist_items.push(key.replace('checklist_', ''));
            } else {
              data[key] = sanitizeInput(value);
            }
          }
          
          // Handle arrays
          if (data.delivery_services) {
            data.delivery_services = data.delivery_services.join(', ');
          }
          
          // Add boolean fields
          data.confirm_accurate = document.getElementById('confirm_accurate')?.checked || false;
          data.consent_automation = document.getElementById('consent_automation')?.checked || false;
          data.consent_to_share = document.getElementById('consent_to_share')?.checked || false;
          data.has_faqs = document.querySelector('input[name="has_faqs"]:checked')?.value === 'true';
          
          // Submit form
          fetch('/api/submit-onboarding', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify(data)
          })
          .then(response => response.json())
          .then(data => {
            if (data.success && data.stripe_url) {
              successMessage.classList.remove('hidden');
              successMessage.textContent = data.message || 'Form submitted successfully!';
              setTimeout(() => {
                window.location.href = data.stripe_url;
              }, 1500);
            } else {
              throw new Error(data.message || 'Submission failed');
            }
          })
          .catch(error => {
            errorMessage.classList.remove('hidden');
            errorMessage.textContent = error.message || 'Network error. Please try again.';
            resetForm();
          });
        });
        
        function resetForm() {
          loadingSpinner.classList.add('hidden');
          submitButton.disabled = false;
          submitButton.textContent = '🎉 Start My Setup';
        }
        
        // Initialize conditional fields
        updateDeliveryPickupFields();
        updateLoginFields();
        updateFaqSection();
      });
    })();
  </script>
</body>
</html>